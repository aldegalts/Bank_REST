databaseChangeLog:
    - changeSet:
          id: 006-create-refresh-tokens
          author: aldegalts
          changes:
              - createTable:
                    tableName: refresh_tokens
                    columns:
                        - column:
                              name: id
                              type: BIGINT
                              autoIncrement: true
                              constraints:
                                  primaryKey: true
                                  nullable: false

                        - column:
                              name: user_id
                              type: BIGINT
                              constraints:
                                  nullable: false

                        - column:
                              name: token
                              type: VARCHAR(512)
                              constraints:
                                  nullable: false

                        - column:
                              name: expiry_date
                              type: TIMESTAMP
                              constraints:
                                  nullable: false

                        - column:
                              name: revoked
                              type: BOOLEAN
                              defaultValueBoolean: false

              - addForeignKeyConstraint:
                    baseTableName: refresh_tokens
                    baseColumnNames: user_id
                    referencedTableName: users
                    referencedColumnNames: id
                    constraintName: fk_refresh_tokens_user

              - createIndex:
                    tableName: refresh_tokens
                    indexName: idx_refresh_tokens_user
                    columns:
                        - column:
                              name: user_id

              - createIndex:
                    tableName: refresh_tokens
                    indexName: idx_refresh_tokens_token
                    columns:
                        - column:
                              name: token
