databaseChangeLog:
    - changeSet:
          id: 003-create-transfers
          author: aldegalts
          changes:
              - createTable:
                    tableName: transfers
                    columns:
                        - column:
                              name: id
                              type: UUID
                              constraints:
                                  primaryKey: true
                                  nullable: false
                        - column:
                              name: from_card_id
                              type: UUID
                              constraints:
                                  nullable: false
                        - column:
                              name: to_card_id
                              type: UUID
                              constraints:
                                  nullable: false
                        - column:
                              name: amount
                              type: DECIMAL(19,2)
                              constraints:
                                  nullable: false
                        - column:
                              name: status
                              type: VARCHAR(20)
                              constraints:
                                  nullable: false
                        - column:
                              name: reason
                              type: TEXT
                        - column:
                              name: created_at
                              type: TIMESTAMP
                              defaultValueComputed: CURRENT_TIMESTAMP

              - addForeignKeyConstraint:
                    baseTableName: transfers
                    baseColumnNames: from_card_id
                    referencedTableName: cards
                    referencedColumnNames: id
                    constraintName: fk_transfers_from_card

              - addForeignKeyConstraint:
                    baseTableName: transfers
                    baseColumnNames: to_card_id
                    referencedTableName: cards
                    referencedColumnNames: id
                    constraintName: fk_transfers_to_card

          rollback:
              - dropTable:
                    tableName: transfers
